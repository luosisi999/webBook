# HTTP

**一、HTTP常见状态码**

按第一个数字分类：1表示信息，2表示成功，3表示重定向，4表示客户端错误，5表示服务器错误

|          状态码           |                             含义                             |
| :-----------------------: | :----------------------------------------------------------: |
|          200 OK           |               请求成功。一般用于get和post请求                |
|   301 Moved Permanently   |    永久移动。请求的信息已经被移动到新的URI，会返回新的URI    |
|         302 Found         |      临时移动。资源只是临时被移动，客户端继续使用原URI       |
|     304 Not Modified      | 未修改。所请求的资源未修改，服务器返回此状态码，不会返回任何资源 |
|      400 Bad Request      | 客户端请求的语法错误，服务器无法理解（产生原因：前端提交的数据在后台找不到与之相对应的实体） |
|     401 Unauthorized      |                     当前请求需要用户验证                     |
|       403 Forbidden       |                服务器已经收到请求，但拒绝执行                |
|       404 Not Found       |               服务器无法根据用户的请求找到资源               |
| 500 Internal Server Error |                 服务器内部错误，无法完成请求                 |

**二、HTTP的首部有哪些？**

- 通用首部：表示一些通用信息，如date表示报文创建时间
- 请求首部：请求报文独有，如cookie、If-Modified-Since
- 响应首部：响应报文独有，如set-cookie、Last-Modified
- 实体首部：描述实体部分，如allow用来描述可执行的请求方法、content-type描述主体类型、content-Encoding描述主体的编码方式

**三、HTTP支持的方法**

|  方法   |                             作用                             |
| :-----: | :----------------------------------------------------------: |
|   get   |     请求指定的页面信息并返回响应主体，一般用于数据的读取     |
|  post   |             向指定资源提交数据，请求服务器去处理             |
|  head   |     获取服务器的响应头信息，常用于客户端查看服务器的性能     |
| options | 请求服务器返回该资源所支持的所有HTTP请求方法，常用于客户端查看服务器的性能 |
|   put   |                 向指定资源位置上传其最新内容                 |
| delete  |             请求服务器删除所请求URI所标识的资源              |
| connect | 将连接改为管道方式的代理服务器，常用于SSL加密服务器与非加密的HTTP代理服务器的通信 |
|  trace  |  请求服务器回显其收到的请求信息，常用于HTTP请求的测试或诊断  |

**四、get和post有什么区别？**

get和post本质上就是TCP链接，并无差别，但由于HTTP的规定和浏览器、服务器的限制，导致它们在应用过程中有一些不同：

- get参数通过URL传递；post放在request body中
- get请求在URL中传递的参数有长度限制；post没有（HTTP协议未规定，是因为浏览器和服务器的限制）
- get请求只能进行URL编码；post请求有多种编码方式
- get请求参数会被完整保留在浏览历史记录里；post中的参数不会被保留
- get产生一个TCP数据包；post产生两个TCP数据包
- 对于get请求，浏览器将http header和data一并发送，服务器响应200 OK；对于post请求，浏览器先发送header，服务器响应100 Continue，浏览器再发送data，服务器响应200 OK
- 缓存方面：get请求类似于查找的过程，用户获取数据，可以不用每次都与数据库连接，所以可以使用缓存；post请求一般做的是修改和删除工作，必须与数据库交互，所以不能使用缓存

**五、http2.0的新特点**

- 基于HTTPS天然具有安全性
- 二进制分帧层：将所有传输信息分割成更小的信息或帧，并进行二进制编码（http2.0性能增强核心）
- 允许多路复用：基于二进制分帧层，在共享TCP连接的基础上，同时发送请求和响应。HTTP消息被分解为独立的帧，而不破坏消息本身的语义，交错发送出去，最后在另一端根据流ID和首部将他们重新组合起来
- 服务器推送：服务端根据客户端的请求，提前返回多个响应，推送额外的资源给客户端，支持缓存（遵循同源策略；基于客户端的请求响应来确定的）

**六、HTTP缓存机制**

1. 两种缓存方式，根据响应的header内容来决定

- 强缓存（状态码：200）：浏览器不向服务器发送任何请求，直接从本地缓存中读取文件并返回（相关字段：Cache-Control、Expires）
- 协商缓存（状态码304）：浏览器发送请求到服务器，通过服务器来告知缓存是否可用（相关字段：Last-Modified/If-Modified-Since、Etag/If-None-Match）

2. 缓存相关header  
   Cache-Control、Expires、Last-Modified/If-Modified-Since、Etag/If-None-Match

3. 流程

   <img src="../Images/HTTP缓存.jpg" style="zoom:85%;" />

   

   参考：[面试精选之http缓存](https://juejin.im/post/5b3c87386fb9a04f9a5cb037)

### 详细描述下http和https
**HTTP** :超文本传输协议，设计的初衷是提供一种发布和接受html页面的方法。http协议是以明文的方式发送信息的，如果黑客截取了web浏览器和服务器之间的传输报文，就可以直接获取其中的信息。

**HTTPs**:HTTP+SSL，是HTTP的安全版，加入SSL层实现加密传输和身份认证

**HTTP和HTTPS的区别**：
- http传输的数据是未加密的，是明文传输；https是具有安全性的SSL加密传输协议。
- https需要SSL 证书；http不用
- http的端口号是80；https的端口号是443

**HTTPS 的缺点：**
1. 握手阶段费事，使得页面加载时间延长。
2. https成本增加，CA证书需要购买
3. https协议的加密范围比较有限。

### http报文详解
一、报文的组成
包括：报文首部和报文主体
* 报文首部：包含服务器或客户端需处理的请求或响应的内容及属性。
* 报文主体：是应该被发送的数据。

二、请求报文首部的结构：
 
--请求行：包含用于请求的方法，请求URI和HTTP版本。
--请求首部字段
--通用首部字段
--实体首部字段
--其它
例子
![4ca8ddb3fba720d4d6745a14a38ccd8b.png](en-resource://database/4961:0)

* 第一行为请求行： GET / HTTP/1.1 方法是GET，协议版本http1.1
* HOST：请求资源所在服务器Connection
* keep-alive：一般情况下，一旦web服务器向浏览器发送了请求数据，他就要关闭TCP连接，然后如果浏览器或者服务器在其头信息加入了Connection:keep-alive，则TCP连接在发送后仍将保持打开状态，于是，浏览器可以继续通过相同的连接发送请求，保持连接节省了为每个请求建立新连接所需要的时间，还节约了网络带宽。
* User-Agent:客户端程序的信息，就是我发送请求的浏览器信息。
* Accept：列出了浏览器可以接收的媒体数据类型：
* Cookie：浏览器记录的用户相关信息。

三、响应报文首部结构
--状态行
--响应首部字段
--通用首部字段
--实体首部字段
--其他


浏览器控制台给出了相应的Reponse Headers:
![3ae9f2954cffcae45f955f79e09df2c3.png](en-resource://database/4963:0)

* 第一行状态行：给出了状态码200，表示请求已被正常处理。
* Server：这是服务器用来告诉客户端当前服务器上安装的HTTP服务器应用程序的信息，可能包含服务器上的软件应用名称，版本号等。
* Content-Type:此字段标明了服务器返回给浏览器的实体内容的类型是text/html，charset为UTF-8。这部分与请求头中的Accept相对应。
* Cache-Control: 缓存控制，默认值为private，表示内容只缓存到私有缓存中(仅客户端可以缓存，代理服务器不可缓存)
* Expires:告知客户端资源失效的日期。当浏览器看到响应中有一个Expires头时，它会和相应的组件一起保存到其缓存中，只要组件没有过期，浏览器就会使用缓存版本而不会进行任何的HTTP请求。
* Set-Cookoe:服务器设置的cookie信息。


四、报文主体
响应报文主体：Response，我们就可以看到服务器返回给浏览器的数据
请求报文主体：post方法发送的数据。